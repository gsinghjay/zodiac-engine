{% extends "layout.html" %}

{% block title %}Chart Details - {{ chart_data.name }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="h2">Astrological Chart</h1>
                <a href="/home" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Generator
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Chart Display Column -->
        <div class="col-lg-8">
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <div class="svg-container">
                        <img src="{{ chart_url }}" alt="Astrological Chart for {{ chart_data.name }}" class="chart-svg img-fluid">
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart Information and Download Options -->
        <div class="col-lg-4">
            <!-- Chart Information -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5 mb-0">Chart Details</h2>
                </div>
                <div class="card-body">
                    <table class="table table-bordered table-sm mb-0">
                        <tbody>
                            <tr>
                                <th>Name</th>
                                <td>{{ chart_data.name }}</td>
                            </tr>
                            <tr>
                                <th>Date & Time</th>
                                <td>{{ chart_data.birth_date }}</td>
                            </tr>
                            <tr>
                                <th>Location</th>
                                <td>{{ chart_data.city }}, {{ chart_data.nation }}</td>
                            </tr>
                            <tr>
                                <th>Coordinates</th>
                                <td>Lat: {{ chart_data.lat }}, Lng: {{ chart_data.lng }}</td>
                            </tr>
                            <tr>
                                <th>House System</th>
                                <td>{{ chart_data.houses_system }}</td>
                            </tr>
                            <tr>
                                <th>Chart Type</th>
                                <td>{{ chart_data.chart_type|capitalize }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Download Options -->
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5 mb-0">Download Options</h2>
                </div>
                <div class="card-body">
                    <div class="list-group">
                        <a href="/download-chart/{{ chart_id }}?format=svg" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            SVG Format
                            <span class="badge bg-primary rounded-pill">
                                <i class="bi bi-download"></i>
                            </span>
                        </a>
                        <a href="/download-chart/{{ chart_id }}?format=png" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            PNG Format
                            <span class="badge bg-primary rounded-pill">
                                <i class="bi bi-download"></i>
                            </span>
                        </a>
                        <a href="/download-chart/{{ chart_id }}?format=pdf" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            PDF Format
                            <span class="badge bg-primary rounded-pill">
                                <i class="bi bi-download"></i>
                            </span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Share Options -->
            <div class="card shadow-sm mt-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5 mb-0">Share Chart</h2>
                </div>
                <div class="card-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" value="{{ request.url }}" id="share-url" readonly>
                        <button class="btn btn-outline-secondary" type="button" onclick="copyShareLink()">
                            Copy
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block head %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<style>
    .chart-svg {
        max-width: 100%;
        height: auto;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    function copyShareLink() {
        const shareUrl = document.getElementById('share-url');
        shareUrl.select();
        shareUrl.setSelectionRange(0, 99999);
        navigator.clipboard.writeText(shareUrl.value);
        
        // Show feedback
        const btn = event.currentTarget;
        const originalText = btn.innerHTML;
        btn.innerHTML = 'Copied!';
        setTimeout(() => {
            btn.innerHTML = originalText;
        }, 2000);
    }
</script>
{% endblock %} 